version: 1.0
runtime: nodejs22

build:
  commands:
    - npm ci
    - npx medusa build
    - cp medusa-config.js .medusa/server/medusa-config.js
    - npm ci --omit=dev --prefix .medusa/server

run:
  network:
    port: 8080
  command: "node .medusa/server/index.js"
  health_check:
    path: /health
    interval: 10
    timeout: 5
    healthy_threshold: 3
    unhealthy_threshold: 3
